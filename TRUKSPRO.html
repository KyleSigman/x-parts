<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>üöõ –†–µ–¥–∞–∫—Ç–æ—Ä —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫–∞</title>
  <style>
    /* –°–¢–ò–õ–ò */
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background-color: #f9f9fb;
      color: #333;
      line-height: 1.6;
      padding: 20px;
      margin: 0;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
    }

    h1 {
        
        font-size: 20px;
      text-align: center;
      margin-bottom: 30px;
      color: #2c3e50;
    }

    .sections {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 30px;
      margin-bottom: 30px;
    }

    @media (max-width: 768px) {
      .sections {
        grid-template-columns: 1fr;
      }
    }

    .section {
      background: white;
      border-radius: 12px;
      padding: 25px;
      box-shadow: 0 4px 15px rgba(0,0,0,0.08);
    }

    .section h2 {
      color: #2c3e50;
      margin-bottom: 20px;
      padding-bottom: 10px;
      border-bottom: 2px solid #eee;
    }

    .wmi-block {
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 1px dashed #eee;
    }

    .pair-line {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 8px;
    }

    .editable {
      padding: 6px 12px;
      border-radius: 6px;
      border: 2px solid transparent;
      min-width: 80px;
      text-align: center;
      font-weight: 600;
    }

    .key {
      background: white;
      border: 2px solid #6c757d;
      color: #495057;
    }

    .value-brand {
      background: #e74c3c;
      color: white;
      border: 2px solid #e74c3c;
    }

    .value-model {
      background: #2980b9;
      color: white;
      border: 2px solid #2980b9;
    }

    .value-engine {
      background: #27ae60;
      color: white;
      border: 2px solid #27ae60;
    }

    input {
      padding: 6px 12px;
      border: 2px solid #4a6fa5;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 600;
      min-width: 80px;
      text-align: center;
    }

    .mini-form {
        max-width: 80vw;
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 10px 0;
      padding: 10px;
      background: #f8f9fa;
      border-radius: 8px;
      border: 2px dashed #dee2e6;
    }
    .mini-form input {
  max-width: 50px;
}
    .form-actions {
      display: flex;
      gap: 5px;
    }

    .btn {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
    }

    .btn-success {
      background: #28a745;
      color: white;
    }

    .btn-danger {
      background: #dc3545;
      color: white;
    }

    .add-btn {
      background: #17a2b8;
      color: white;
      border: none;
      border-radius: 6px;
      padding: 8px 16px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 600;
      margin-top: 10px;
    }

    .models-list {
      margin-top: 15px;
      padding-left: 20px;
      border-left: 2px dashed #dee2e6;
    }

    .engine-group {
      margin-bottom: 15px;
      padding: 15px;
      background: #f8f9fa;
      border-radius: 8px;
    }
  </style>
  <style>
    .editable {
  cursor: pointer;
  transition: all 0.2s ease;
}

.editable:hover {
  transform: scale(1.05);
  box-shadow: 0 2px 8px rgba(0,0,0,0.15);
}

.edit-input {
  padding: 4px 8px;
  border: 2px solid #4a6fa5;
  border-radius: 4px;
  font-size: 14px;
  font-weight: 600;
  max-width: 50px;
  text-align: center;
}

  </style>
  <style>
    .garage-btn {
  position: absolute;
  left: 20px;
  top: 20px;
  padding: 10px 15px;
  background: #2c3e50;
  color: white;
  text-decoration: none;
  border-radius: 6px;
  z-index: 1000;
}
  </style>
</head>
<body>
  <div class="container">
    <h1>üöõ TRUCK SYSTEM</h1>
    <a href="index.html" class="garage-btn">–í –≥–∞—Ä–∞–∂</a>
    
    <div class="sections">
      <!-- –ë—Ä–µ–Ω–¥—ã –∏ –º–æ–¥–µ–ª–∏ -->
      <div class="section">
        <h2>üè≠ –ë—Ä–µ–Ω–¥—ã –∏ –º–æ–¥–µ–ª–∏</h2>
        <div id="brands-container"></div>
      </div>

      <!-- –î–≤–∏–≥–∞—Ç–µ–ª–∏ -->
      <div class="section">
        <h2>‚öôÔ∏è –î–≤–∏–≥–∞—Ç–µ–ª–∏ –∏ –º–æ–¥–µ–ª–∏</h2>
        <div id="engines-container"></div>
      </div>
    </div>
  </div>

  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
  
  <script>
    const firebaseConfig = {
            apiKey: "AIzaSyCVr3ZztynpNzkeFY3aLKFN777oPunon4o",
            authDomain: "inspector-24f9b.firebaseapp.com",
            databaseURL: "https://inspector-24f9b-default-rtdb.europe-west1.firebasedatabase.app",
            projectId: "inspector-24f9b",
            storageBucket: "inspector-24f9b.firebasestorage.app",
            messagingSenderId: "590955045913",
            appId: "1:590955045913:web:164311eb98caeca7643688"
        };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    let WMI_MAP = {};
    let MODEL_TO_ENGINE = {};

    // === –ú–∏–Ω–∏-—Ñ–æ—Ä–º–∞ –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–∞—Ä ===
    function createMiniForm(container, onSave, onCancel) {
      const form = document.createElement('div');
      form.className = 'mini-form';
      
      form.innerHTML = `
        <input type="text" placeholder="–∫–æ–¥" class="key-input">
        <span>‚Üí</span>
        <input type="text" placeholder="–∑–Ω–∞—á–µ–Ω–∏–µ" class="value-input">
        <div class="form-actions">
          <button class="btn btn-success">‚úì</button>
          <button class="btn btn-danger">‚úó</button>
        </div>
      `;

      const keyInput = form.querySelector('.key-input');
      const valueInput = form.querySelector('.value-input');
      const saveBtn = form.querySelector('.btn-success');
      const cancelBtn = form.querySelector('.btn-danger');

      saveBtn.onclick = () => {
        const key = keyInput.value.trim();
        const value = valueInput.value.trim();
        if (key && value) {
          onSave(key, value);
        }
      };

      cancelBtn.onclick = onCancel;

      container.appendChild(form);
      keyInput.focus();
    }

    // === –§—É–Ω–∫—Ü–∏—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ–ª—è ===
function makeEditable(element, onSave) {
  const originalValue = element.textContent;
  const input = document.createElement('input');
  input.type = 'text';
  input.value = originalValue;
  input.className = 'edit-input';
  
  // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
  const originalClasses = element.className;
  
  // –ó–∞–º–µ–Ω—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –Ω–∞ input
  element.parentNode.replaceChild(input, element);
  input.focus();
  input.select();

  function save() {
    const newValue = input.value.trim();
    if (newValue && newValue !== originalValue) {
      onSave(newValue);
    } else {
      cancel();
    }
  }

  function cancel() {
    input.parentNode.replaceChild(element, input);
    element.textContent = originalValue;
    element.className = originalClasses;
  }

  input.addEventListener('blur', save);
  input.addEventListener('keypress', (e) => {
    if (e.key === 'Enter') save();
    if (e.key === 'Escape') cancel();
  });
}

// === –†–µ–Ω–¥–µ—Ä –±—Ä–µ–Ω–¥–æ–≤ —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º ===
function renderBrands() {
  const container = document.getElementById('brands-container');
  container.innerHTML = '';

  for (const [wmi, data] of Object.entries(WMI_MAP)) {
    const wmiBlock = document.createElement('div');
    wmiBlock.className = 'wmi-block';

    // WMI –∏ –±—Ä–µ–Ω–¥
    wmiBlock.innerHTML = `
      <div class="pair-line">
        <span class="editable key">${wmi}</span>
        <span>‚Üí</span>
        <span class="editable value-brand">${data.brand}</span>
      </div>
      <div class="models-list" id="models-${wmi}"></div>
      <button class="add-btn" onclick="addModelToBrand('${wmi}')">+ –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å</button>
    `;

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è WMI –∏ –±—Ä–µ–Ω–¥–∞
    const wmiElement = wmiBlock.querySelector('.pair-line .key');
    const brandElement = wmiBlock.querySelector('.pair-line .value-brand');

    wmiElement.onclick = () => makeEditable(wmiElement, async (newWmi) => {
      if (newWmi !== wmi && newWmi) {
        // –ü–µ—Ä–µ–º–µ—â–∞–µ–º –¥–∞–Ω–Ω—ã–µ –Ω–∞ –Ω–æ–≤—ã–π WMI
        WMI_MAP[newWmi] = WMI_MAP[wmi];
        delete WMI_MAP[wmi];
        await saveToFirebase();
        renderBrands();
      }
    });

    brandElement.onclick = () => makeEditable(brandElement, async (newBrand) => {
      if (newBrand) {
        WMI_MAP[wmi].brand = newBrand;
        await saveToFirebase();
        renderBrands();
      }
    });

    // –ú–æ–¥–µ–ª–∏
        // –ú–æ–¥–µ–ª–∏
    const modelsContainer = wmiBlock.querySelector(`#models-${wmi}`);
    for (const [code, model] of Object.entries(data.models)) {
      const modelLine = document.createElement('div');
      modelLine.className = 'pair-line';
      modelLine.innerHTML = `
        <span class="editable key">${code}</span>
        <span>‚Üí</span>
        <span class="editable value-model">${model}</span>
        <button class="delete-pair-btn">‚õî</button>
      `;

      const deleteBtn = modelLine.querySelector('.delete-pair-btn');
      deleteBtn.onclick = async () => {
        delete WMI_MAP[wmi].models[code];
        await saveToFirebase();
        renderBrands();
      };

      const codeElement = modelLine.querySelector('.key');
      const modelElement = modelLine.querySelector('.value-model');

      codeElement.onclick = () => makeEditable(codeElement, async (newCode) => {
        if (newCode && newCode !== code) {
          const updatedModels = {};
          for (const [key, value] of Object.entries(WMI_MAP[wmi].models)) {
            if (key === code) {
              updatedModels[newCode] = value;
            } else {
              updatedModels[key] = value;
            }
          }
          WMI_MAP[wmi].models = updatedModels;
          await saveToFirebase();
          renderBrands();
        }
      });

      modelElement.onclick = () => makeEditable(modelElement, async (newModel) => {
        if (newModel) {
          WMI_MAP[wmi].models[code] = newModel;
          await saveToFirebase();
          renderBrands();
        }
      });

      modelsContainer.appendChild(modelLine);
    }

    container.appendChild(wmiBlock);
  }
}
    // === –†–µ–Ω–¥–µ—Ä –±—Ä–µ–Ω–¥–æ–≤ ===
    // function renderBrands() {
    //   const container = document.getElementById('brands-container');
    //   container.innerHTML = '';

    //   for (const [wmi, data] of Object.entries(WMI_MAP)) {
    //     const wmiBlock = document.createElement('div');
    //     wmiBlock.className = 'wmi-block';

    //     // WMI –∏ –±—Ä–µ–Ω–¥
    //     wmiBlock.innerHTML = `
    //       <div class="pair-line">
    //         <span class="editable key">${wmi}</span>
    //         <span>‚Üí</span>
    //         <span class="editable value-brand">${data.brand}</span>
    //       </div>
    //       <div class="models-list" id="models-${wmi}"></div>
    //       <button class="add-btn" onclick="addModelToBrand('${wmi}')">+ –î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å</button>
    //     `;

    //     // –ú–æ–¥–µ–ª–∏
    //     const modelsContainer = wmiBlock.querySelector(`#models-${wmi}`);
    //     for (const [code, model] of Object.entries(data.models)) {
    //       const modelLine = document.createElement('div');
    //       modelLine.className = 'pair-line';
    //       modelLine.innerHTML = `
    //         <span class="editable key">${code}</span>
    //         <span>‚Üí</span>
    //         <span class="editable value-model">${model}</span>
    //       `;
    //       modelsContainer.appendChild(modelLine);
    //     }

    //     container.appendChild(wmiBlock);
    //   }
    // }

    // === –†–µ–Ω–¥–µ—Ä –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π ===
    // === –†–µ–Ω–¥–µ—Ä –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π —Å —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º ===
function renderEngines() {
  const container = document.getElementById('engines-container');
  container.innerHTML = '';

  const engineToModels = {};
  for (const [model, engine] of Object.entries(MODEL_TO_ENGINE)) {
    if (!engineToModels[engine]) engineToModels[engine] = [];
    engineToModels[engine].push(model);
  }

  for (const [engine, models] of Object.entries(engineToModels)) {
    const engineGroup = document.createElement('div');
    engineGroup.className = 'engine-group';
    
    const engineLine = document.createElement('div');
    engineLine.className = 'pair-line';
    engineLine.innerHTML = `
      <span class="editable value-engine">${engine}</span>
      <span>‚Üí</span>
    `;

    const modelsContainer = document.createElement('div');
    modelsContainer.className = 'models-container';
    modelsContainer.style.display = 'flex';
    modelsContainer.style.gap = '8px';
    modelsContainer.style.flexWrap = 'wrap';
    modelsContainer.style.alignItems = 'center';

    models.sort().forEach(model => {
      const modelSpan = document.createElement('span');
      modelSpan.className = 'editable value-model';
      modelSpan.textContent = model;
      modelSpan.style.cursor = 'pointer';
      
      // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
      modelSpan.onclick = () => makeEditable(modelSpan, async (newModel) => {
  if (newModel && newModel !== model) {
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –±–µ–∑ undefined
    const updatedModelToEngine = {};
    for (const [modelKey, engineValue] of Object.entries(MODEL_TO_ENGINE)) {
      if (modelKey === model) {
        updatedModelToEngine[newModel] = engineValue;
      } else {
        updatedModelToEngine[modelKey] = engineValue;
      }
    }
    MODEL_TO_ENGINE = updatedModelToEngine;
    await saveToFirebase();
    renderEngines();
  }
});
    //   modelSpan.onclick = () => makeEditable(modelSpan, async (newModel) => {
    //     if (newModel && newModel !== model) {
    //       // –û–±–Ω–æ–≤–ª—è–µ–º —Å–≤—è–∑—å
    //       MODEL_TO_ENGINE[newModel] = MODEL_TO_ENGINE[model];
    //       delete MODEL_TO_ENGINE[model];
    //       await saveToFirebase();
    //       renderEngines();
    //     }
    //   });
      
      modelsContainer.appendChild(modelSpan);
    });

    // –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–≤–∏–≥–∞—Ç–µ–ª—è
    const engineElement = engineLine.querySelector('.value-engine');
    engineElement.onclick = () => makeEditable(engineElement, async (newEngine) => {
  if (newEngine && newEngine !== engine) {
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –±–µ–∑ undefined
    const updatedModelToEngine = {};
    for (const [modelKey, engineValue] of Object.entries(MODEL_TO_ENGINE)) {
      if (engineValue === engine) {
        updatedModelToEngine[modelKey] = newEngine;
      } else {
        updatedModelToEngine[modelKey] = engineValue;
      }
    }
    MODEL_TO_ENGINE = updatedModelToEngine;
    await saveToFirebase();
    renderEngines();
  }
});
    // engineElement.onclick = () => makeEditable(engineElement, async (newEngine) => {
    //   if (newEngine && newEngine !== engine) {
    //     // –û–±–Ω–æ–≤–ª—è–µ–º –≤—Å–µ —Å–≤—è–∑–∏ –¥–ª—è —ç—Ç–æ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
    //     models.forEach(model => {
    //       MODEL_TO_ENGINE[model] = newEngine;
    //     });
    //     await saveToFirebase();
    //     renderEngines();
    //   }
    // });

    engineLine.appendChild(modelsContainer);
    engineGroup.appendChild(engineLine);
    container.appendChild(engineGroup);
  }

  const addBtn = document.createElement('button');
  addBtn.className = 'add-btn';
  addBtn.textContent = '+ –î–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑–∫—É';
  addBtn.onclick = addEngineLink;
  container.appendChild(addBtn);
}
// function renderEngines() {
//   const container = document.getElementById('engines-container');
//   container.innerHTML = '';

//   const engineToModels = {};
//   for (const [model, engine] of Object.entries(MODEL_TO_ENGINE)) {
//     if (!engineToModels[engine]) engineToModels[engine] = [];
//     engineToModels[engine].push(model);
//   }

//   for (const [engine, models] of Object.entries(engineToModels)) {
//     const engineGroup = document.createElement('div');
//     engineGroup.className = 'engine-group';
    
//     const engineLine = document.createElement('div');
//     engineLine.className = 'pair-line';
//     engineLine.innerHTML = `
//       <span class="editable value-engine">${engine}</span>
//       <span>‚Üí</span>
//     `;

//     const modelsContainer = document.createElement('div');
//     modelsContainer.className = 'models-container';
//     modelsContainer.style.display = 'flex';
//     modelsContainer.style.gap = '8px';
//     modelsContainer.style.flexWrap = 'wrap';
//     modelsContainer.style.alignItems = 'center';

//     models.sort().forEach(model => {
//       const modelSpan = document.createElement('span');
//       modelSpan.className = 'editable value-model';
//       modelSpan.textContent = model;
//       modelSpan.style.cursor = 'pointer';
//       modelsContainer.appendChild(modelSpan);
//     });

//     engineLine.appendChild(modelsContainer);
//     engineGroup.appendChild(engineLine);
//     container.appendChild(engineGroup);
//   }

//   const addBtn = document.createElement('button');
//   addBtn.className = 'add-btn';
//   addBtn.textContent = '+ –î–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑–∫—É';
//   addBtn.onclick = addEngineLink;
//   container.appendChild(addBtn);
// }

    // // === –†–µ–Ω–¥–µ—Ä –¥–≤–∏–≥–∞—Ç–µ–ª–µ–π ===
    // function renderEngines() {
    //   const container = document.getElementById('engines-container');
    //   container.innerHTML = '';

    //   // –ì—Ä—É–ø–ø–∏—Ä—É–µ–º –º–æ–¥–µ–ª–∏ –ø–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è–º
    //   const engineToModels = {};
    //   for (const [model, engine] of Object.entries(MODEL_TO_ENGINE)) {
    //     if (!engineToModels[engine]) engineToModels[engine] = [];
    //     engineToModels[engine].push(model);
    //   }

    //   // –†–µ–Ω–¥–µ—Ä–∏–º –≥—Ä—É–ø–ø—ã
    //   for (const [engine, models] of Object.entries(engineToModels)) {
    //     const engineGroup = document.createElement('div');
    //     engineGroup.className = 'engine-group';
        
    //     engineGroup.innerHTML = `
    //       <div class="pair-line">
    //         <span class="editable value-engine">${engine}</span>
    //         <span>‚Üí</span>
    //         <span>${models.sort().join(', ')}</span>
    //       </div>
    //     `;

    //     container.appendChild(engineGroup);
    //   }

    //   // –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è
    //   const addBtn = document.createElement('button');
    //   addBtn.className = 'add-btn';
    //   addBtn.textContent = '+ –î–æ–±–∞–≤–∏—Ç—å —Å–≤—è–∑–∫—É';
    //   addBtn.onclick = addEngineLink;
    //   container.appendChild(addBtn);
    // }

    // === –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –∫ –±—Ä–µ–Ω–¥—É ===
    function addModelToBrand(wmi) {
      const modelsContainer = document.getElementById(`models-${wmi}`);
      
      createMiniForm(modelsContainer, 
        async (code, model) => {
          // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
          WMI_MAP[wmi].models[code] = model;
          
          // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firebase
          await saveToFirebase();
          
          // –ü–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–º
          renderBrands();
          renderEngines();
        },
        () => {
          // –û—Ç–º–µ–Ω–∞ - –ø—Ä–æ—Å—Ç–æ —É–¥–∞–ª—è–µ–º —Ñ–æ—Ä–º—É
          modelsContainer.removeChild(modelsContainer.lastChild);
        }
      );
    }

    // === –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–≤—è–∑–∫–∏ –¥–≤–∏–≥–∞—Ç–µ–ª—å-–º–æ–¥–µ–ª—å ===
    function addEngineLink() {
      const container = document.getElementById('engines-container');
      const addBtn = container.querySelector('.add-btn');
      container.removeChild(addBtn);
      
      createMiniForm(container,
        async (model, engine) => {
          // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ
          MODEL_TO_ENGINE[model] = engine;
          
          // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤ Firebase
          await saveToFirebase();
          
          // –ü–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–º
          renderEngines();
        },
        () => {
          // –û—Ç–º–µ–Ω–∞ - –ø–µ—Ä–µ—Ä–µ–Ω–¥–µ—Ä–∏–º —á—Ç–æ–±—ã –≤–µ—Ä–Ω—É—Ç—å –∫–Ω–æ–ø–∫—É
          renderEngines();
        }
      );
    }

    // === –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ Firebase ===
    async function saveToFirebase() {
      try {
        await db.collection('TRUCKSYSTEM').doc('reference_data').update({
          WMI_MAP: WMI_MAP,
          MODEL_TO_ENGINE: MODEL_TO_ENGINE
        });
        console.log('‚úÖ –î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã');
      } catch (error) {
        console.error('‚ùå –û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è:', error);
      }
    }

    // === –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö ===
    async function loadData() {
      try {
        const docRef = db.collection('TRUCKSYSTEM').doc('reference_data');
        const docSnap = await docRef.get();
        
        if (docSnap.exists) {
          const data = docSnap.data();
          WMI_MAP = data.WMI_MAP || {};
          MODEL_TO_ENGINE = data.MODEL_TO_ENGINE || {};
          
          renderBrands();
          renderEngines();
        }
      } catch (error) {
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏:', error);
      }
    }

    // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
    window.addModelToBrand = addModelToBrand;
    window.addEngineLink = addEngineLink;

    // –ó–∞–ø—É—Å–∫
    loadData();
  </script>
</body>

</html>
